# 🛡️ ShieldUs 사용자 시나리오

## 애플리케이션 개요

사용자들이 프로그래밍 문제를 풀고, 자신의 풀이를 제출하며, 다른 문제들을 탐색하고, 필요시 관리자와 소통할 수 있는 온라인 코딩 테스트 플랫폼입니다.  
JWT 기반 인증을 통해 안전한 사용자 경험을 제공하며, 명확한 예외 처리로 안정성을 높였습니다.

---

## 1. 계정 관리

### 1.1. 회원가입 (Register)

- **사용자**: 신규 사용자
- **시나리오**:
  1. 회원가입 페이지 접근
  2. 이메일, 비밀번호, 이름, 전화번호 입력
  3. 가입하기 클릭
- **유효성 검사**:
  - 이메일: `@Email`, `@NotBlank`
  - 비밀번호: `@Size(8~20)`, `@NotBlank`
  - 전화번호: `@Pattern(숫자 10~11자리)`
- **시스템 동작**:
  - 중복 이메일 검사 (`existsByEmail`)
  - 비밀번호 암호화 (BCryptPasswordEncoder)
  - `Member` 저장 (기본 ROLE: USER)
- **응답**: 회원가입 성공 메시지 반환

---

### 1.2. 로그인 (Login)

- **사용자**: 기존 사용자
- **시나리오**:
  1. 이메일, 비밀번호 입력
  2. 로그인 버튼 클릭
- **시스템 동작**:
  - `JwtAuthenticationFilter` → 인증
  - `MemberUserDetailsService` → 사용자 조회
  - 실패 시: `401 Unauthorized`
  - 성공 시: JWT 발급 (Header: `Authorization`)
- **예상 결과**: 로그인 후 메인 페이지로 이동, JWT는 이후 요청에 포함

---

### 1.3. 내 정보 조회 (My Page)

- **사용자**: 로그인된 사용자
- **시나리오**:
  1. 마이페이지 접속
  2. 프로필과 문제 풀이 정보 확인
- **시스템 동작**:
  - `/api/members/me` GET 요청 (JWT 포함)
  - 본인 정보 조회 + `pass=true` 문제 조회
  - `MyPageResponseDto` 반환

---

### 1.4. 회원 정보 수정 (Update Profile)

- **시나리오**:
  1. 이름, 이메일, 비밀번호 수정
  2. 저장 버튼 클릭
- **시스템 동작**:
  - PUT `/api/members/me`
  - 이메일 중복 시 검사
  - 비밀번호 암호화 후 저장
- **응답**: 수정 성공 메시지

---

### 1.5. 회원 탈퇴 (Soft Delete Account)

- **시나리오**:
  1. 탈퇴 버튼 클릭 → 확인
- **시스템 동작**:
  - DELETE `/api/members/me`
  - `isDeleted = true`, `deletedAt = 현재 시간`
- **응답**: 로그아웃 및 비활성화 처리

---

## 2. 문제 관리

### 2.1. 문제 목록 조회 (List Problems)

- **사용자**: 로그인/비로그인 모두 가능
- **시나리오**:
  - 필터 조건(category, level, title 등)으로 조회
  - 페이지네이션
- **시스템 동작**:
  - GET `/api/problems`
  - QueryDSL + 조건 필터
  - 로그인 시 풀이 여부도 함께 조회
- **응답**: 문제 목록 + 통과 여부

---

### 2.2. 문제 상세 조회 (View Problem Detail)

- **시나리오**:
  - 제목 클릭 시 상세 정보 확인
- **시스템 동작**:
  - GET `/api/problems/{problemId}`
  - 문제, 테스트 케이스, 작성자, 해결 여부 조회
- **응답**: 문제 상세 DTO 반환

---

### 2.3. 문제 생성 (Create Problem) - ADMIN 전용

- **시나리오**:
  - 제목, 설명, 난이도, 테스트 케이스 작성
  - 생성 버튼 클릭
- **시스템 동작**:
  - POST `/api/problems` (JWT 포함)
  - `@PreAuthorize("hasRole('ADMIN')")`
  - 테스트케이스 저장
- **응답**: 생성된 문제 ID 반환

---

### 2.4. 문제 수정 (Update Problem) - ADMIN 전용

- **시나리오**:
  - 문제 정보 및 테스트케이스 수정/추가
- **시스템 동작**:
  - PUT `/api/problems/{problemId}`
  - testCaseId 존재 여부로 분기 처리
- **응답**: 수정된 문제 ID 반환

---

### 2.5. 문제 삭제 (Soft Delete Problem) - ADMIN 전용

- **시나리오**:
  - 삭제 버튼 클릭 → 확인
- **시스템 동작**:
  - DELETE `/api/problems/{problemId}`
  - `isDeleted = true`, `deletedAt = 현재 시간`
- **응답**: 삭제 완료

---

## 3. 문제 풀이 및 제출

### 3.1. 코드 제출 및 컴파일/테스트

- **시나리오**:
  - 코드 작성 → 테스트 버튼 클릭
- **시스템 동작**:
  - POST `/api/problems/compile`
  - 테스트케이스 조회 → 채점 서버 호출
- **응답**:
  - 입력, 기대 출력, 실제 출력, 통과 여부 반환

---

### 3.2. 정답 코드 제출 및 저장

- **시나리오**:
  - 정답 제출 버튼 클릭
- **시스템 동작**:
  - POST `/api/problems/{problemId}/submit`
  - 히든 케이스 포함 채점
  - `MemberSubmitProblem`, `MemberTempCode` 저장
- **응답**: 제출 결과 메시지

---

### 3.3. 이전 제출 코드 확인

- **시나리오**:
  - 문제 상세/기록 페이지에서 이전 코드 확인
- **시스템 동작**:
  - GET `/api/problems/{problemId}/submissions`
  - 최신 제출 코드 조회
- **응답**: 코드 + 결과 상태 반환

---

## 4. 관리자 기능 (Admin Specific)

### 4.1. 사용자 목록 조회

- **시나리오**:
  - 모든 사용자 조회
- **시스템 동작**:
  - GET `/api/admin/members`
  - `findAll(Pageable)` + DTO 변환
- **응답**: 전체 회원 정보 목록

---

### 4.2. 사용자 정보 강제 수정

- **시나리오**:
  - 이름, 이메일, 비밀번호, 권한 수정
- **시스템 동작**:
  - PUT `/api/admin/members/{memberId}`
  - Member 정보 수정 + 암호화 저장
- **응답**: 수정 성공 메시지

---

### 4.3. 사용자 계정 강제 삭제

- **시나리오**:
  - 회원 삭제 → 확인
- **시스템 동작**:
  - DELETE `/api/admin/members/{memberId}`
  - `isDeleted = true`, `deletedAt = 현재 시간`
- **응답**: 삭제 완료 응답

---

## 🔐 사용자 로그인 시나리오

- 이메일 + 비밀번호 기반 로그인
- Member 테이블에 존재하면 성공 → JWT 발급 + 쿠키 저장
- 실패 시 에러 메시지 반환

